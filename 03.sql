CREATE TABLE IF NOT EXISTS aoc2020_03
(
    section TEXT
);

INSERT INTO aoc2020_03
VALUES
--     ('...............#.#.............'), ignore first line for reasons
       ('##..#....................#...##'),
       ('......#..#.#.....#..#.#.##.....'),
       ('.........#...#..............#.#'),
       ('............#.......##.........'),
       ('...#.....#.....#...#.....#..#..'),
       ('..............#..##.#..#......#'),
       ('.##.....#.....#......##.#......'),
       ('.#..........###....#...##....#.'),
       ('.....#....#.#.......#......##..'),
       ('.#....#......#.......#........#'),
       ('..#.#.......#..##.....##.......'),
       ('...#.#....#.......#.......#...#'),
       ('##.##...##..#......#.#.....#..#'),
       ('.#.#.......#..#.#......#...#.#.'),
       ('#.......##.......#...#.........'),
       ('.....#......#.#.#.....#....##..'),
       ('.#.#........#....#..#..#.......'),
       ('...#....#..###.........#.....#.'),
       ('........#........#........#....'),
       ('..##..............#.....#.#..#.'),
       ('.#...##.............#.#........'),
       ('....#..#...........#.......#...'),
       ('..#....#.....................#.'),
       ('#.#..................##......##'),
       ('.#.##....#......#........#.....'),
       ('.........##.....#....#...##..#.'),
       ('#..........#..#.#.............#'),
       ('.........#...#.#.#.#..##..##...'),
       ('#...#.....#..#..#....#...#.....'),
       ('..##.....#..................#..'),
       ('#..###.....#....#.......#..#...'),
       ('...##.##..#............#......#'),
       ('........###.........###......#.'),
       ('#..##....#.........#.........#.'),
       ('....#.....................#....'),
       ('#..#..##..#..####.##..#.....##.'),
       ('..#...#.#....#....##.....#.....'),
       ('...#.#.........#.....#.#.......'),
       ('....#................#..#...##.'),
       ('....#..#..........#...#.#.##...'),
       ('........#..##............#....#'),
       ('...#......##..........#.##...#.'),
       ('.......##......................'),
       ('.......##..........#....#.#...#'),
       ('......###.##..##..#....#...#..#'),
       ('#.#...........##.....#........#'),
       ('..#...........#..###....#.#.#..'),
       ('........#...........#......##..'),
       ('.........#...##.###...###..#...'),
       ('.....#.....#..##.........##....'),
       ('...##..............#.....#...##'),
       ('.##....#.......###.....#.......'),
       ('.#...........##.............##.'),
       ('......#..#..##.##......#......#'),
       ('........###........#......#.#..'),
       ('#.#....#.....#........#......#.'),
       ('.##..#.........##...##....#....'),
       ('.....#.........#...##.....#....'),
       ('.............#........###....#.'),
       ('......#.......#.#........#.#...'),
       ('..#....#.#...#....#...#.#...##.'),
       ('#...#......##..##......#.##.###'),
       ('...##.#....#...#....#.........#'),
       ('...#..####.....##.#..#.#...##..'),
       ('##.#..#....##......#......##...'),
       ('###.........#.#..#.#.....#.....'),
       ('...#........#..##...#.#.#..#.#.'),
       ('...###..#.###.#...#............'),
       ('....................###........'),
       ('...........#...........#.......'),
       ('#..............#.#.........###.'),
       ('....................##.....#..#'),
       ('#.#.....#.......#...#..........'),
       ('.#...#......#....##...#...#....'),
       ('.....#.##..................###.'),
       ('.........#.#..#.#......#.......'),
       ('.......#.....##..#.##.#........'),
       ('..#..........#.###.....#....#..'),
       ('......#.............#.#........'),
       ('........##....#........#.......'),
       ('...#.............#....#.#......'),
       ('#........#..####.....#.....#.#.'),
       ('.##......##...#........#..#.#..'),
       ('....##....#...#...#..##...#.#..'),
       ('#.##...###..#....##.#..........'),
       ('....#.#...#.#...#..##.###...#..'),
       ('#.....##..#..#....#.#.....##...'),
       ('.#..#..........##.#.....##.....'),
       ('.#..#........#.#.#.#...........'),
       ('.#..#.....#...........#...#....'),
       ('...#......##..........##..#....'),
       ('...#..#....#.##...#..#.....###.'),
       ('#.#....#.....##................'),
       ('#..#......#.#.#.......#........'),
       ('......#....#.#....#..##....#..#'),
       ('.#.....#.#....###.##.........#.'),
       ('.###..#.....#........#.#.......'),
       ('.#...#......#..#.#......#.....#'),
       ('#...............####...#.....#.'),
       ('.......#..........##.#........#'),
       ('#........##....##.....###..##..'),
       ('#..#.....#..##.....#....#..#...'),
       ('#.....#.......##......#.#.....#'),
       ('#.##..#......##..#.............'),
       ('##...#.....#........##.........'),
       ('....#..##....#...#.......#.#...'),
       ('....#...#...##..#....#..#...#..'),
       ('..............#.#...#....###...'),
       ('...#....#..##...##..#....##....'),
       ('#.##.#..#..#......#.#.#.#...#..'),
       ('.......#..#..##........#......#'),
       ('##.#....#....##.#......##.#....'),
       ('.#...#..............#........#.'),
       ('.#.#....#.........#............'),
       ('.#..#..###.............#....#..'),
       ('#......#...#.#..##..#...#....#.'),
       ('.......................#...#.#.'),
       ('.............#..#...##.........'),
       ('..#.#..#....#....#........#....'),
       ('#......#.##..#...#.#...........'),
       ('.....#....#...........##.#..#..'),
       ('..#.#.....#..............#.#...'),
       ('#.......#.....#................'),
       ('#..............#...#....#...#..'),
       ('...#...##..#..#............#...'),
       ('......###.....................#'),
       ('.........#.......##..#....#....'),
       ('........#...#.##..#.##......#..'),
       ('....###..#.#...#...#..#.#...###'),
       ('##...#...##.#...#.#...#.#....#.'),
       ('.........#...#.....###.........'),
       ('...#........##..#.......##.....'),
       ('.#.......##.........#.....##..#'),
       ('.#..................#...#......'),
       ('.##..#..#.#.....#.###..........'),
       ('...#.....##..#.........#...#...'),
       ('.#......#.#.......#.#..........'),
       ('.........#.#...#..........#.#..'),
       ('#..........#.##..#.##....#.....'),
       ('.#.#....#.....#..##.....#...#..'),
       ('..#........##...##..#..#....#..'),
       ('#...........##....#..###....#..'),
       ('...........##.........####...#.'),
       ('..#........###...#.#.........#.'),
       ('.#...............#.##.#.#...#..'),
       ('.#.##..#.....#.#.....##..#.....'),
       ('...#...#..#.##.##...#.......##.'),
       ('..#...#...#......##.##.##...#..'),
       ('##....#...#...#...............#'),
       ('...##...........#......#..#.#..'),
       ('#.........#......#.#.##.....#..'),
       ('........#..#.........##........'),
       ('..#.#....###.....##..#...#.....'),
       ('.........#...#.......#.....##..'),
       ('##.....................#...##..'),
       ('.#.#..#......#.................'),
       ('.....###..#......#..###..#.....'),
       ('...#.....##.........#......#..#'),
       ('......##.....#...#........#.#..'),
       ('..#.#...#......#...#.##.##.....'),
       ('...#..........#...#.......#..##'),
       ('.###........#........##........'),
       ('..#.#.#..........#.#...##......'),
       ('.........#........#......###..#'),
       ('....##..#.........#...........#'),
       ('..####..#............##.......#'),
       ('.....##.#..##.........#...#.#..'),
       ('...#.........#.....#.....#.....'),
       ('.......#...#..#...##.........#.'),
       ('...#...#..#...#....#..#........'),
       ('#............##.##...#.........'),
       ('.#.#.....#.......####.....#....'),
       ('..............#......#.#.......'),
       ('..............#...........#...#'),
       ('#...#........###....#.#....#.#.'),
       ('##.#..#..#......#......#.#.#...'),
       ('.#..#.....#..#.#..#.#.......##.'),
       ('......##.#...#...#......#...#..'),
       ('#...........##....#.#..........'),
       ('....#.......###.#...#..........'),
       ('.......................#.....#.'),
       ('........#...#..#...#.#.#.#.#...'),
       ('.#.#...........#......##...#...'),
       ('.........................#.....'),
       ('.................#.##.#...##...'),
       ('...#...##.....#.....##....#.#..'),
       ('...#...#...................#...'),
       ('...#..#..#...#...#....#........'),
       ('#....#...#.....#...............'),
       ('.......#...........#...#.......'),
       ('....#....#.....##.......#......'),
       ('.......#..........##...........'),
       ('.#.#........#..##....#......#..'),
       ('.....#.......#.#.........#...#.'),
       ('.#..####.#.#...............#..#'),
       ('.....###..#..#..........#.#..##'),
       ('..#.......#...#.....##..#..#.#.'),
       ('#....#......#..................'),
       ('........#.##.#....#...........#'),
       ('....#.#....##..#.#.....##......'),
       ('...#..#.......#....#.....#.#.#.'),
       ('#...#......#.....#.#..........#'),
       ('....#....#...............#.....'),
       ('..###......................###.'),
       ('.##....#..#.......###.....#..#.'),
       ('..###............#........#.##.'),
       ('.#........#......#.....#..#....'),
       ('....#..##...#...#.###.......#.#'),
       ('.......#.##...........#.#..#...'),
       ('.....#...##....................'),
       ('....#....#...##......#.........'),
       ('..#............##....###.#...#.'),
       ('.#........#...............#....'),
       ('#..#.#.##.........#..##....##..'),
       ('#.#....#..#.##....##...#.#.....'),
       ('.....#.....##....#.#........#..'),
       ('#..#...#...#....#....#.........'),
       ('...#........#..#.#.....##......'),
       ('..#...#...#................##..'),
       ('#........#.#.##.......#.#...#..'),
       ('#......#..####.##.....#.#..#.#.'),
       ('............#..#.#....#......##'),
       ('..#.....##....#...#.#..........'),
       ('...#...#.........#...#.#.......'),
       ('.###..#.......##.##.....#.#.#..'),
       ('...#....#...............##.#...'),
       ('....##..#..#..#.#......##.....#'),
       ('#.#..............##...##...####'),
       ('.....#.##...#.#...............#'),
       ('.##.....#.........#.......#.#.#'),
       ('#.#..#.....#.......#.......#..#'),
       ('...#.#.....#.....#......#......'),
       ('.......#....#..#.#..........#..'),
       ('......#......#.##...#..........'),
       ('.....#.......###...#...#.#.....'),
       ('#..#.#.........#.....#.##....#.'),
       ('..#.#.........#..#..#..#.....#.'),
       ('.#..##..#..#....#......#.##..#.'),
       ('...##......###.....#.##.##.....'),
       ('.#.....#...#..#...#............'),
       ('##..##..#.##....#..#...........'),
       ('...#..##..#..#.............#.##'),
       ('...............##............#.'),
       ('..#.....##........##.#...#....#'),
       ('.#.#...#.#.#..#.#.....#....#...'),
       ('.#....#...............#..#.....'),
       ('....#.##..#....#......#...###..'),
       ('#................###...#.#.....'),
       ('...#...#......##..#.#....#.....'),
       ('.#....#....#.#...##............'),
       ('....#...##..#..#........#.##...'),
       ('..##.....#..#..##..............'),
       ('..#..##..#.#..##....#....#....#'),
       ('...##.............#............'),
       ('#....#....#.#........#.....##.#'),
       ('.....#..#.#.....####...###.....'),
       ('................#......#.......'),
       ('.....#.#.#.#.#....#..#........#'),
       ('.##.#...#.#.......##....#....#.'),
       ('.....#........#................'),
       ('..#.....#..#...#..#...........#'),
       ('.#.....#...##.....##..#.#....##'),
       ('......#.......#..#......##.#...'),
       ('#.#..........#.##.#........#...'),
       ('...#..#.............#..........'),
       ('#..#..#..........#..##.#.......'),
       ('.#..#...............####..#....'),
       ('.......#.....#......#.....#.#..'),
       ('.#...............#...#.........'),
       ('.#..#..........#..#.#..##..#..#'),
       ('......##..#.....#..#......###..'),
       ('..........#...#..#.......#.....'),
       ('.#.#.#..#.....#.##.#...#..#....'),
       ('........#.......#.....#.#......'),
       ('......#.....##.....#....##.#...'),
       ('...............#......#.......#'),
       ('..#.#...#.....#.#...##......#..'),
       ('#.#.........#.#...#........####'),
       ('#..........##..#..#........##..'),
       ('.............#..#.......##.#..#'),
       ('..#........#.#....#........#.#.'),
       ('.#......####..#..#.............'),
       ('............###.......#.#..#...'),
       ('#.##......##...#...#.........#.'),
       ('....##.#.#.#......#....#..#...#'),
       ('.#..#.#....#...#.........#.....'),
       ('#...#.....##............#...#..'),
       ('#.#...#..#.................#...'),
       ('............#.#..#.....#.#.#..#'),
       ('...................#....#.##...'),
       ('.....#...#.#....#....#.#......#'),
       ('.......##.#.#......##..........'),
       ('.#..#...##.#...#..#......#.....'),
       ('......#.#..#..###..##..##......'),
       ('.#.#.#.#.....#...###.....#..#..'),
       ('.#....#.....#.......#.......#..'),
       ('..........##.........####......'),
       ('.#.#.............#..#.#...#....'),
       ('........#........##...#.#....#.'),
       ('........#......................'),
       ('..#.#....#...............#...##'),
       ('.......#.#...#..#.....##......#'),
       ('.#...#....#..........##........'),
       ('.#.........#.#............##...'),
       ('.....#......##...#.......#..#..'),
       ('#.#..#.............#...#...#...'),
       ('......#.......#............#...'),
       ('...........##....#......##.....'),
       ('.#.#..#.....................#..'),
       ('##..##.....###..##.#...........'),
       ('...##......##....#...##.....#..'),
       ('#...#.##.............#.........'),
       ('......#..#.........###.#......#'),
       ('#.#.....#.....................#'),
       ('....#####.....##........#.#..#.'),
       ('...........##..##.###..........'),
       ('..........##.....#........#...#'),
       ('.......#..#......#.....##..##.#'),
       ('.....##.#........#.........#...'),
       ('......##......................#'),
       ('.#.......#.#.#............#..#.'),
       ('.....##.#.......#.#........#...');

SELECT tree, section
FROM (SELECT concat(substring(section, 1, CAST(row_number() OVER () AS INT) * 3 % 31), 'O',
                    substring(section, CAST(row_number() OVER () AS INT) * 3 % 31 + 2))  AS section,
             substring(section, CAST(row_number() OVER () AS INT) * 3 % 31 + 1, 1) = '#' AS tree
      FROM aoc2020_03
     ) AS pulkkamaki WHERE tree = true;


